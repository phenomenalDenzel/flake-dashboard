{"ast":null,"code":"var _jsxFileName = \"/home/denzel/flake-dashboard/src/container/AquireBuilder/SearchResult/SearchResult.js\";\nimport React, { useState, useEffect } from \"react\";\nimport styles from \"./SearchResult.module.css\";\nimport StarRating from \"../../../ui/star/StarRating\";\nimport Spinner from \"../../../ui/loader/Spinner/Spinner\";\nimport Aux from \"../../../hoc/Aux\";\nimport axios from \"../../../axios-scrape\";\nimport ScrapeLoader from \"../../../ui/loader/ScrapeLoader/ScrapeLoader\";\nimport { Link } from \"react-router-dom\";\nconst maps = [{\n  googleBook: {\n    title: \"This is title\",\n    averageRating: 4.5,\n    authors: [{\n      authorNames: \"blablas\"\n    }],\n    imageLink: \"\"\n  },\n  amazonBook: {\n    title: \"This is title\",\n    averageRating: 4.23,\n    authorNames: \"bla bla\",\n    imageLink: \"\"\n  }\n}];\n\nconst SearchResult = props => {\n  const [books, setBooks] = useState([]);\n  const [loading, setLoading] = useState(false);\n  const [pagenatedLoading, setPagenatedLoading] = useState(false);\n  const [error, setError] = useState(null);\n  const [searchTerm, setSearchTerm] = useState(\"\");\n  useEffect(() => {\n    // window.addEventListener(\"scroll\", performScrollEvent);\n    const query = new URLSearchParams(props.location.search);\n    let search = \"\";\n\n    for (let param of query.entries()) {\n      search = param[1];\n    }\n\n    console.log(sessionStorage.getItem(\"books\"));\n    console.log(sessionStorage.getItem(\"searchQuery\")); // if (books.length === 0 && sessionStorage.getItem(\"books\")) {\n    //   setBooks(JSON.parse(sessionStorage.getItem(\"books\")));\n    // }\n\n    if (!searchTerm && sessionStorage.getItem(\"searchQuery\")) {\n      console.log(\"see\");\n      setSearchTerm(sessionStorage.getItem(\"searchQuery\"));\n    }\n\n    if (books.length === 0) {\n      console.log(\"book empty\");\n    }\n\n    if (!searchTerm) {\n      console.log(\"No search\");\n    }\n\n    loadData(search);\n    return () => {// window.removeEventListener(\"scroll\", performScrollEvent);\n    };\n\n    function loadData(search) {\n      console.log(\"j\", !JSON.parse(sessionStorage.getItem(\"books\")));\n      console.log(\"s \" + search, \"st \" + searchTerm);\n\n      if (search !== \"\") {\n        if (!JSON.parse(sessionStorage.getItem(\"books\"))) {\n          console.log(\"Making request\");\n          setLoading(true);\n          setSearchTerm(search);\n          setBooks([]); // axios\n          //   .get(`?q=${search}`)\n          //   .then((res) => {\n          //     setBooks(cleanData(res.data));\n          //     sessionStorage.clear();\n          //     sessionStorage.setItem(\"books\", JSON.stringify(books));\n          //     sessionStorage.setItem(\"searchQuery\", search);\n          //     // console.log(cleanData(res.data));\n          //     setLoading(false);\n          //   })\n          //   .catch((error) => {\n          //     setLoading(false);\n          //     setError(error.message);\n          //   });\n\n          setTimeout(function () {\n            setBooks(maps);\n            sessionStorage.setItem(\"books\", JSON.stringify(books));\n            sessionStorage.setItem(\"searchQuery\", search);\n            setLoading(false);\n          }, 1000);\n        }\n      }\n\n      console.log(error);\n    }\n\n    function performScrollEvent() {\n      const scrollable = document.documentElement.scrollHeight - window.innerHeight;\n      const scrolled = window.scrollY;\n\n      if (Math.ceil(scrolled) === scrollable) {\n        getMoreBooks(books.length + 1);\n      }\n    }\n\n    function getMoreBooks(startIndex) {\n      // this.setState({ pagenatedLoading: true });\n      setPagenatedLoading(true);\n      axios.get(`?q=${searchTerm}&maxResults=10&startIndex=${startIndex}`).then(res => {\n        // this.setState({\n        //   books: [...this.state.books.concat(this.cleanData(res.data.items))],\n        //   pagenatedLoading: false,\n        // });\n        setBooks([...books.concat(cleanData(res.data.items))]);\n      }).catch(error => {\n        setError(error);\n        setPagenatedLoading(false);\n      });\n    }\n  }, [props.location.search], searchTerm);\n\n  const cleanData = book => {\n    // const cleanedDate = books.map((book) => {\n    //   if (!book.volumeInfo.hasOwnProperty(\"imageLinks\")) {\n    //     book.volumeInfo[\"imageLinks\"] = {\n    //       thumbnail:\n    //         \"https://vignette.wikia.nocookie.net/pandorahearts/images/a/ad/Not_available.jpg/revision/latest?cb=20141028171337\",\n    //     };\n    //   }\n    //   if (!book.volumeInfo.hasOwnProperty(\"authors\")) {\n    //     book.volumeInfo[\"authors\"] = [];\n    //   }\n    //   return book;\n    // });\n    const books = [];\n\n    for (let key in book) {\n      const bookSet = book[key];\n      let amazonImage = \"\";\n\n      if (bookSet.hasOwnProperty(\"abeBook\")) {\n        amazonImage = bookSet[\"abeBook\"].goodreadsImageLink;\n      }\n\n      if (bookSet.hasOwnProperty(\"amazonBook\")) {\n        bookSet.amazonBook[\"imageLink\"] = amazonImage;\n      }\n\n      for (let key in bookSet) {\n        const bookItem = bookSet[key];\n\n        if (bookItem.imageLink === \"\") {\n          bookItem[\"imageLink\"] = \"https://vignette.wikia.nocookie.net/pandorahearts/images/a/ad/Not_available.jpg/revision/latest?cb=20141028171337\";\n        }\n      }\n\n      books.push(bookSet);\n    }\n\n    return books;\n  };\n\n  let results = loading ? /*#__PURE__*/React.createElement(ScrapeLoader, {\n    __self: this,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 168,\n      columnNumber: 27\n    }\n  }) : null;\n\n  if (error === \"Network Error\") {\n    results = /*#__PURE__*/React.createElement(\"p\", {\n      __self: this,\n      __source: {\n        fileName: _jsxFileName,\n        lineNumber: 170,\n        columnNumber: 15\n      }\n    }, \"Check your network dumbass\");\n  }\n\n  if (books.length > 0) {\n    results = /*#__PURE__*/React.createElement(\"div\", {\n      __self: this,\n      __source: {\n        fileName: _jsxFileName,\n        lineNumber: 174,\n        columnNumber: 7\n      }\n    }, books.length, /*#__PURE__*/React.createElement(\"ul\", {\n      className: styles.BookList,\n      __self: this,\n      __source: {\n        fileName: _jsxFileName,\n        lineNumber: 176,\n        columnNumber: 9\n      }\n    }, books.map(book => {\n      return /*#__PURE__*/React.createElement(Link, {\n        to: \"/acquire_new/\" + book[\"googleBook\"].id,\n        __self: this,\n        __source: {\n          fileName: _jsxFileName,\n          lineNumber: 179,\n          columnNumber: 15\n        }\n      }, /*#__PURE__*/React.createElement(\"li\", {\n        className: styles.BookItem,\n        key: book[\"googleBook\"].id,\n        __self: this,\n        __source: {\n          fileName: _jsxFileName,\n          lineNumber: 180,\n          columnNumber: 17\n        }\n      }, /*#__PURE__*/React.createElement(\"div\", {\n        className: styles.ThumbnailSection,\n        __self: this,\n        __source: {\n          fileName: _jsxFileName,\n          lineNumber: 181,\n          columnNumber: 19\n        }\n      }, /*#__PURE__*/React.createElement(\"img\", {\n        src: book[\"googleBook\"].imageLink,\n        alt: \"book\",\n        __self: this,\n        __source: {\n          fileName: _jsxFileName,\n          lineNumber: 182,\n          columnNumber: 21\n        }\n      })), /*#__PURE__*/React.createElement(\"div\", {\n        className: styles.BookSummary,\n        __self: this,\n        __source: {\n          fileName: _jsxFileName,\n          lineNumber: 184,\n          columnNumber: 19\n        }\n      }, /*#__PURE__*/React.createElement(\"h3\", {\n        __self: this,\n        __source: {\n          fileName: _jsxFileName,\n          lineNumber: 185,\n          columnNumber: 21\n        }\n      }, book[\"googleBook\"].title), /*#__PURE__*/React.createElement(\"h4\", {\n        __self: this,\n        __source: {\n          fileName: _jsxFileName,\n          lineNumber: 186,\n          columnNumber: 21\n        }\n      }, /*#__PURE__*/React.createElement(\"span\", {\n        __self: this,\n        __source: {\n          fileName: _jsxFileName,\n          lineNumber: 187,\n          columnNumber: 23\n        }\n      }, \"by \"), book[\"googleBook\"].authors.map(author => author.authorNames).join(\", \")), /*#__PURE__*/React.createElement(StarRating, {\n        rate: book[\"googleBook\"].averageRating,\n        __self: this,\n        __source: {\n          fileName: _jsxFileName,\n          lineNumber: 192,\n          columnNumber: 21\n        }\n      }))));\n    })), pagenatedLoading ? /*#__PURE__*/React.createElement(Spinner, {\n      __self: this,\n      __source: {\n        fileName: _jsxFileName,\n        lineNumber: 199,\n        columnNumber: 29\n      }\n    }) : null);\n  }\n\n  return /*#__PURE__*/React.createElement(Aux, {\n    __self: this,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 203,\n      columnNumber: 10\n    }\n  }, \" \", results, \" \");\n};\n\nexport default SearchResult;","map":{"version":3,"sources":["/home/denzel/flake-dashboard/src/container/AquireBuilder/SearchResult/SearchResult.js"],"names":["React","useState","useEffect","styles","StarRating","Spinner","Aux","axios","ScrapeLoader","Link","maps","googleBook","title","averageRating","authors","authorNames","imageLink","amazonBook","SearchResult","props","books","setBooks","loading","setLoading","pagenatedLoading","setPagenatedLoading","error","setError","searchTerm","setSearchTerm","query","URLSearchParams","location","search","param","entries","console","log","sessionStorage","getItem","length","loadData","JSON","parse","setTimeout","setItem","stringify","performScrollEvent","scrollable","document","documentElement","scrollHeight","window","innerHeight","scrolled","scrollY","Math","ceil","getMoreBooks","startIndex","get","then","res","concat","cleanData","data","items","catch","book","key","bookSet","amazonImage","hasOwnProperty","goodreadsImageLink","bookItem","push","results","BookList","map","id","BookItem","ThumbnailSection","BookSummary","author","join"],"mappings":"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","sourcesContent":["import React, { useState, useEffect } from \"react\";\nimport styles from \"./SearchResult.module.css\";\nimport StarRating from \"../../../ui/star/StarRating\";\nimport Spinner from \"../../../ui/loader/Spinner/Spinner\";\nimport Aux from \"../../../hoc/Aux\";\nimport axios from \"../../../axios-scrape\";\nimport ScrapeLoader from \"../../../ui/loader/ScrapeLoader/ScrapeLoader\";\nimport { Link } from \"react-router-dom\";\n\nconst maps = [\n  {\n    googleBook: {\n      title: \"This is title\",\n      averageRating: 4.5,\n      authors: [\n        {\n          authorNames: \"blablas\",\n        },\n      ],\n      imageLink: \"\",\n    },\n    amazonBook: {\n      title: \"This is title\",\n      averageRating: 4.23,\n      authorNames: \"bla bla\",\n      imageLink: \"\",\n    },\n  },\n];\nconst SearchResult = (props) => {\n  const [books, setBooks] = useState([]);\n  const [loading, setLoading] = useState(false);\n  const [pagenatedLoading, setPagenatedLoading] = useState(false);\n  const [error, setError] = useState(null);\n  const [searchTerm, setSearchTerm] = useState(\"\");\n\n  useEffect(\n    () => {\n      // window.addEventListener(\"scroll\", performScrollEvent);\n      const query = new URLSearchParams(props.location.search);\n      let search = \"\";\n      for (let param of query.entries()) {\n        search = param[1];\n      }\n      console.log(sessionStorage.getItem(\"books\"));\n      console.log(sessionStorage.getItem(\"searchQuery\"));\n      // if (books.length === 0 && sessionStorage.getItem(\"books\")) {\n      //   setBooks(JSON.parse(sessionStorage.getItem(\"books\")));\n      // }\n\n      if (!searchTerm && sessionStorage.getItem(\"searchQuery\")) {\n        console.log(\"see\");\n        setSearchTerm(sessionStorage.getItem(\"searchQuery\"));\n      }\n\n      if (books.length === 0) {\n        console.log(\"book empty\");\n      }\n      if (!searchTerm) {\n        console.log(\"No search\");\n      }\n      loadData(search);\n\n      return () => {\n        // window.removeEventListener(\"scroll\", performScrollEvent);\n      };\n      function loadData(search) {\n        console.log(\"j\", !JSON.parse(sessionStorage.getItem(\"books\")));\n        console.log(\"s \" + search, \"st \" + searchTerm);\n\n        if (search !== \"\") {\n          if (!JSON.parse(sessionStorage.getItem(\"books\"))) {\n            console.log(\"Making request\");\n            setLoading(true);\n            setSearchTerm(search);\n            setBooks([]);\n            // axios\n            //   .get(`?q=${search}`)\n            //   .then((res) => {\n            //     setBooks(cleanData(res.data));\n            //     sessionStorage.clear();\n            //     sessionStorage.setItem(\"books\", JSON.stringify(books));\n            //     sessionStorage.setItem(\"searchQuery\", search);\n            //     // console.log(cleanData(res.data));\n            //     setLoading(false);\n            //   })\n            //   .catch((error) => {\n            //     setLoading(false);\n            //     setError(error.message);\n            //   });\n            setTimeout(function () {\n              setBooks(maps);\n              sessionStorage.setItem(\"books\", JSON.stringify(books));\n              sessionStorage.setItem(\"searchQuery\", search);\n              setLoading(false);\n            }, 1000);\n          }\n        }\n        console.log(error);\n      }\n\n      function performScrollEvent() {\n        const scrollable =\n          document.documentElement.scrollHeight - window.innerHeight;\n        const scrolled = window.scrollY;\n        if (Math.ceil(scrolled) === scrollable) {\n          getMoreBooks(books.length + 1);\n        }\n      }\n\n      function getMoreBooks(startIndex) {\n        // this.setState({ pagenatedLoading: true });\n        setPagenatedLoading(true);\n        axios\n          .get(`?q=${searchTerm}&maxResults=10&startIndex=${startIndex}`)\n          .then((res) => {\n            // this.setState({\n            //   books: [...this.state.books.concat(this.cleanData(res.data.items))],\n            //   pagenatedLoading: false,\n            // });\n            setBooks([...books.concat(cleanData(res.data.items))]);\n          })\n          .catch((error) => {\n            setError(error);\n            setPagenatedLoading(false);\n          });\n      }\n    },\n    [props.location.search],\n    searchTerm\n  );\n\n  const cleanData = (book) => {\n    // const cleanedDate = books.map((book) => {\n    //   if (!book.volumeInfo.hasOwnProperty(\"imageLinks\")) {\n    //     book.volumeInfo[\"imageLinks\"] = {\n    //       thumbnail:\n    //         \"https://vignette.wikia.nocookie.net/pandorahearts/images/a/ad/Not_available.jpg/revision/latest?cb=20141028171337\",\n    //     };\n    //   }\n    //   if (!book.volumeInfo.hasOwnProperty(\"authors\")) {\n    //     book.volumeInfo[\"authors\"] = [];\n    //   }\n    //   return book;\n    // });\n    const books = [];\n    for (let key in book) {\n      const bookSet = book[key];\n      let amazonImage = \"\";\n      if (bookSet.hasOwnProperty(\"abeBook\")) {\n        amazonImage = bookSet[\"abeBook\"].goodreadsImageLink;\n      }\n      if (bookSet.hasOwnProperty(\"amazonBook\")) {\n        bookSet.amazonBook[\"imageLink\"] = amazonImage;\n      }\n      for (let key in bookSet) {\n        const bookItem = bookSet[key];\n        if (bookItem.imageLink === \"\") {\n          bookItem[\"imageLink\"] =\n            \"https://vignette.wikia.nocookie.net/pandorahearts/images/a/ad/Not_available.jpg/revision/latest?cb=20141028171337\";\n        }\n      }\n      books.push(bookSet);\n    }\n    return books;\n  };\n\n  let results = loading ? <ScrapeLoader /> : null;\n  if (error === \"Network Error\") {\n    results = <p>Check your network dumbass</p>;\n  }\n  if (books.length > 0) {\n    results = (\n      <div>\n        {books.length}\n        <ul className={styles.BookList}>\n          {books.map((book) => {\n            return (\n              <Link to={\"/acquire_new/\" + book[\"googleBook\"].id}>\n                <li className={styles.BookItem} key={book[\"googleBook\"].id}>\n                  <div className={styles.ThumbnailSection}>\n                    <img src={book[\"googleBook\"].imageLink} alt=\"book\" />\n                  </div>\n                  <div className={styles.BookSummary}>\n                    <h3>{book[\"googleBook\"].title}</h3>\n                    <h4>\n                      <span>by </span>\n                      {book[\"googleBook\"].authors\n                        .map((author) => author.authorNames)\n                        .join(\", \")}\n                    </h4>\n                    <StarRating rate={book[\"googleBook\"].averageRating} />\n                  </div>\n                </li>\n              </Link>\n            );\n          })}\n        </ul>\n        {pagenatedLoading ? <Spinner /> : null}\n      </div>\n    );\n  }\n  return <Aux> {results} </Aux>;\n};\n\nexport default SearchResult;\n"]},"metadata":{},"sourceType":"module"}