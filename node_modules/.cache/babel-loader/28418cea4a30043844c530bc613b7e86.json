{"ast":null,"code":"var _jsxFileName = \"/home/denzel/flake-dashboard/src/container/AquireBuilder/SearchResult/SearchResult.js\";\nimport React, { useState, useEffect } from \"react\";\nimport styles from \"./SearchResult.module.css\";\nimport StarRating from \"../../../ui/star/StarRating\";\nimport Spinner from \"../../../ui/loader/Spinner/Spinner\";\nimport Aux from \"../../../hoc/Aux\";\nimport axios from \"../../../axios-scrape\";\nimport ScrapeLoader from \"../../../ui/loader/ScrapeLoader/ScrapeLoader\";\nimport { Link } from \"react-router-dom\";\n\nconst SearchResult = () => {\n  const [books, setBooks] = useState([]);\n  const [loading, setLoading] = useState(false);\n  const [pagenatedLoading, setPagenatedLoading] = useState(false);\n  const [error, setError] = useState(null);\n  const [searchTerm, setSearchTerm] = useState(\"\");\n  useEffect(() => {\n    window.addEventListener(\"scroll\", performScrollEvent);\n    const query = new URLSearchParams(props.location.search);\n    let search = \"\";\n\n    for (let param of query.entries()) {\n      search = param[1];\n    }\n\n    loadData(search);\n    return () => {\n      window.removeEventListener(\"scroll\", performScrollEvent);\n    };\n  }, [books, props.location.search]); // state = {\n  //   books: [],\n  //   loading: false,\n  //   pagenatedLoading: false,\n  //   error: null,\n  //   searchTerm: \"\",\n  // };\n\n  function loadData(search) {\n    if (search) {\n      if (!books || search !== searchTerm) {\n        console.log(\"making request\"); // this.setState({ loading: true, searchTerm: search, books: [] });\n\n        setLoading(true);\n        setSearchTerm(search);\n        setBooks([]);\n        axios.get(`?q=${search}&maxResults=10&startIndex=0`).then(res => {\n          console.log(res); // this.setState({\n          //   books: this.cleanData(res.data.items),\n          //   loading: false,\n          // });\n\n          setBooks(cleanData(res.data.items));\n          setLoading(false);\n        }).catch(error => {\n          setLoading(false);\n          setError(error);\n        });\n      }\n    }\n  }\n\n  cleanData = books => {\n    const cleanedDate = books.map(book => {\n      if (!book.volumeInfo.hasOwnProperty(\"imageLinks\")) {\n        book.volumeInfo[\"imageLinks\"] = {\n          thumbnail: \"https://vignette.wikia.nocookie.net/pandorahearts/images/a/ad/Not_available.jpg/revision/latest?cb=20141028171337\"\n        };\n      }\n\n      if (!book.volumeInfo.hasOwnProperty(\"authors\")) {\n        book.volumeInfo[\"authors\"] = [];\n      }\n\n      return book;\n    });\n    return cleanedDate;\n  };\n\n  const getMoreBooks = startIndex => {\n    // this.setState({ pagenatedLoading: true });\n    setPagenatedLoading(true);\n    axios.get(`?q=${searchTerm}&maxResults=10&startIndex=${startIndex}`).then(res => {\n      // this.setState({\n      //   books: [...this.state.books.concat(this.cleanData(res.data.items))],\n      //   pagenatedLoading: false,\n      // });\n      setBooks([...books.concat(cleanData(res.data.items))]);\n    }).catch(error => {\n      setError(error);\n      setPagenatedLoading(false);\n    });\n  }; // componentDidMount() {\n  //   window.addEventListener(\"scroll\", this.performScrollEvent);\n  //   this.loadData();\n  // }\n  // componentDidUpdate() {\n  //   this.loadData();\n  // }\n  // componentWillUnmount() {\n  //   window.removeEventListener(\"scroll\", this.performScrollEvent);\n  // }\n\n\n  performScrollEvent = () => {\n    const scrollable = document.documentElement.scrollHeight - window.innerHeight;\n    const scrolled = window.scrollY;\n\n    if (Math.ceil(scrolled) === scrollable) {\n      getMoreBooks(books.length + 1);\n    }\n  };\n\n  let results = loading ? /*#__PURE__*/React.createElement(ScrapeLoader, {\n    __self: this,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 120,\n      columnNumber: 27\n    }\n  }) : null;\n\n  if (books.length > 0) {\n    console.log(\"yes\");\n    results = /*#__PURE__*/React.createElement(\"div\", {\n      __self: this,\n      __source: {\n        fileName: _jsxFileName,\n        lineNumber: 124,\n        columnNumber: 7\n      }\n    }, /*#__PURE__*/React.createElement(\"ul\", {\n      className: styles.BookList,\n      __self: this,\n      __source: {\n        fileName: _jsxFileName,\n        lineNumber: 125,\n        columnNumber: 9\n      }\n    }, books.map(book => {\n      return /*#__PURE__*/React.createElement(Link, {\n        to: \"/acquire_new/\" + book.id,\n        __self: this,\n        __source: {\n          fileName: _jsxFileName,\n          lineNumber: 128,\n          columnNumber: 15\n        }\n      }, /*#__PURE__*/React.createElement(\"li\", {\n        className: styles.BookItem,\n        key: book.id,\n        __self: this,\n        __source: {\n          fileName: _jsxFileName,\n          lineNumber: 129,\n          columnNumber: 17\n        }\n      }, /*#__PURE__*/React.createElement(\"div\", {\n        className: styles.ThumbnailSection,\n        __self: this,\n        __source: {\n          fileName: _jsxFileName,\n          lineNumber: 130,\n          columnNumber: 19\n        }\n      }, /*#__PURE__*/React.createElement(\"img\", {\n        src: book.volumeInfo.imageLinks.thumbnail,\n        alt: \"book\",\n        __self: this,\n        __source: {\n          fileName: _jsxFileName,\n          lineNumber: 131,\n          columnNumber: 21\n        }\n      })), /*#__PURE__*/React.createElement(\"div\", {\n        className: styles.BookSummary,\n        __self: this,\n        __source: {\n          fileName: _jsxFileName,\n          lineNumber: 136,\n          columnNumber: 19\n        }\n      }, /*#__PURE__*/React.createElement(\"h3\", {\n        __self: this,\n        __source: {\n          fileName: _jsxFileName,\n          lineNumber: 137,\n          columnNumber: 21\n        }\n      }, book.volumeInfo.title), /*#__PURE__*/React.createElement(\"h4\", {\n        __self: this,\n        __source: {\n          fileName: _jsxFileName,\n          lineNumber: 138,\n          columnNumber: 21\n        }\n      }, /*#__PURE__*/React.createElement(\"span\", {\n        __self: this,\n        __source: {\n          fileName: _jsxFileName,\n          lineNumber: 139,\n          columnNumber: 23\n        }\n      }, \"by \"), book.volumeInfo.authors.join(\", \")), /*#__PURE__*/React.createElement(StarRating, {\n        rate: book.volumeInfo.averageRating,\n        __self: this,\n        __source: {\n          fileName: _jsxFileName,\n          lineNumber: 142,\n          columnNumber: 21\n        }\n      }))));\n    })), pagenatedLoading ? /*#__PURE__*/React.createElement(Spinner, {\n      __self: this,\n      __source: {\n        fileName: _jsxFileName,\n        lineNumber: 149,\n        columnNumber: 29\n      }\n    }) : null);\n  }\n\n  return /*#__PURE__*/React.createElement(Aux, {\n    __self: this,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 153,\n      columnNumber: 10\n    }\n  }, \" \", results, \" \");\n};\n\nexport default SearchResult;","map":{"version":3,"sources":["/home/denzel/flake-dashboard/src/container/AquireBuilder/SearchResult/SearchResult.js"],"names":["React","useState","useEffect","styles","StarRating","Spinner","Aux","axios","ScrapeLoader","Link","SearchResult","books","setBooks","loading","setLoading","pagenatedLoading","setPagenatedLoading","error","setError","searchTerm","setSearchTerm","window","addEventListener","performScrollEvent","query","URLSearchParams","props","location","search","param","entries","loadData","removeEventListener","console","log","get","then","res","cleanData","data","items","catch","cleanedDate","map","book","volumeInfo","hasOwnProperty","thumbnail","getMoreBooks","startIndex","concat","scrollable","document","documentElement","scrollHeight","innerHeight","scrolled","scrollY","Math","ceil","length","results","BookList","id","BookItem","ThumbnailSection","imageLinks","BookSummary","title","authors","join","averageRating"],"mappings":"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","sourcesContent":["import React, { useState, useEffect } from \"react\";\nimport styles from \"./SearchResult.module.css\";\nimport StarRating from \"../../../ui/star/StarRating\";\nimport Spinner from \"../../../ui/loader/Spinner/Spinner\";\nimport Aux from \"../../../hoc/Aux\";\nimport axios from \"../../../axios-scrape\";\nimport ScrapeLoader from \"../../../ui/loader/ScrapeLoader/ScrapeLoader\";\nimport { Link } from \"react-router-dom\";\n\nconst SearchResult = () => {\n  const [books, setBooks] = useState([]);\n  const [loading, setLoading] = useState(false);\n  const [pagenatedLoading, setPagenatedLoading] = useState(false);\n  const [error, setError] = useState(null);\n  const [searchTerm, setSearchTerm] = useState(\"\");\n\n  useEffect(() => {\n    window.addEventListener(\"scroll\", performScrollEvent);\n    const query = new URLSearchParams(props.location.search);\n    let search = \"\";\n    for (let param of query.entries()) {\n      search = param[1];\n    }\n    loadData(search);\n    return () => {\n      window.removeEventListener(\"scroll\", performScrollEvent);\n    };\n  }, [books, props.location.search]);\n  // state = {\n  //   books: [],\n  //   loading: false,\n  //   pagenatedLoading: false,\n  //   error: null,\n  //   searchTerm: \"\",\n  // };\n\n  function loadData(search) {\n    if (search) {\n      if (!books || search !== searchTerm) {\n        console.log(\"making request\");\n        // this.setState({ loading: true, searchTerm: search, books: [] });\n        setLoading(true);\n        setSearchTerm(search);\n        setBooks([]);\n        axios\n          .get(`?q=${search}&maxResults=10&startIndex=0`)\n          .then((res) => {\n            console.log(res);\n            // this.setState({\n            //   books: this.cleanData(res.data.items),\n            //   loading: false,\n            // });\n            setBooks(cleanData(res.data.items));\n            setLoading(false);\n          })\n          .catch((error) => {\n            setLoading(false);\n            setError(error);\n          });\n      }\n    }\n  }\n\n  cleanData = (books) => {\n    const cleanedDate = books.map((book) => {\n      if (!book.volumeInfo.hasOwnProperty(\"imageLinks\")) {\n        book.volumeInfo[\"imageLinks\"] = {\n          thumbnail:\n            \"https://vignette.wikia.nocookie.net/pandorahearts/images/a/ad/Not_available.jpg/revision/latest?cb=20141028171337\",\n        };\n      }\n      if (!book.volumeInfo.hasOwnProperty(\"authors\")) {\n        book.volumeInfo[\"authors\"] = [];\n      }\n      return book;\n    });\n    return cleanedDate;\n  };\n\n  const getMoreBooks = (startIndex) => {\n    // this.setState({ pagenatedLoading: true });\n    setPagenatedLoading(true);\n    axios\n      .get(`?q=${searchTerm}&maxResults=10&startIndex=${startIndex}`)\n      .then((res) => {\n        // this.setState({\n        //   books: [...this.state.books.concat(this.cleanData(res.data.items))],\n        //   pagenatedLoading: false,\n        // });\n        setBooks([...books.concat(cleanData(res.data.items))]);\n      })\n      .catch((error) => {\n        setError(error);\n        setPagenatedLoading(false);\n      });\n  };\n\n  // componentDidMount() {\n  //   window.addEventListener(\"scroll\", this.performScrollEvent);\n  //   this.loadData();\n  // }\n\n  // componentDidUpdate() {\n  //   this.loadData();\n  // }\n\n  // componentWillUnmount() {\n  //   window.removeEventListener(\"scroll\", this.performScrollEvent);\n  // }\n\n  performScrollEvent = () => {\n    const scrollable =\n      document.documentElement.scrollHeight - window.innerHeight;\n    const scrolled = window.scrollY;\n    if (Math.ceil(scrolled) === scrollable) {\n      getMoreBooks(books.length + 1);\n    }\n  };\n\n  let results = loading ? <ScrapeLoader /> : null;\n  if (books.length > 0) {\n    console.log(\"yes\");\n    results = (\n      <div>\n        <ul className={styles.BookList}>\n          {books.map((book) => {\n            return (\n              <Link to={\"/acquire_new/\" + book.id}>\n                <li className={styles.BookItem} key={book.id}>\n                  <div className={styles.ThumbnailSection}>\n                    <img\n                      src={book.volumeInfo.imageLinks.thumbnail}\n                      alt=\"book\"\n                    />\n                  </div>\n                  <div className={styles.BookSummary}>\n                    <h3>{book.volumeInfo.title}</h3>\n                    <h4>\n                      <span>by </span>\n                      {book.volumeInfo.authors.join(\", \")}\n                    </h4>\n                    <StarRating rate={book.volumeInfo.averageRating} />\n                  </div>\n                </li>\n              </Link>\n            );\n          })}\n        </ul>\n        {pagenatedLoading ? <Spinner /> : null}\n      </div>\n    );\n  }\n  return <Aux> {results} </Aux>;\n};\n\nexport default SearchResult;\n"]},"metadata":{},"sourceType":"module"}